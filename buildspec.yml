version: 0.2

phases:
  install:
    runtime-versions:
      nodejs: 20
    commands:
      - echo Installing dependencies
      - npm install

  pre_build:
    commands:
      - echo Running linter
      - npm run lint || echo "No lint script found"

  build:
    commands:
      - echo Running tests
      - npm test || echo "No tests yet"

  post_build:
    commands:
      - echo Running smoke checks
      - test -f index.html
      - grep -q "Omotoyosi" index.html 
      - grep -q "DevOps" index.html
      - echo All checks passed

artifacts:
  files:
    - server.js
    - index.html
    - package.json
    - package-lock.json